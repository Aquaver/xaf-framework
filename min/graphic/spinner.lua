local a=require("xaf/graphic/component")local b=require("xaf/core/xafcore")local c=b:getMathInstance()local d={C_NAME="Generic GUI Spinner",C_INSTANCE=true,C_INHERIT=true,static={MODE_DEFAULT=0,MODE_COUNTER=1,MODE_ITERATOR=2}}function d:initialize()local e=a:extend()local f=e and e.private or{}local g=e and e.public or{}f.eventClick=nil;f.eventClickArguments={}f.eventScroll=nil;f.eventScrollArguments={}f.spinnerMode=0;f.contentIndex=1;f.contentLength=0;f.contentTable={}g.getValue=function(self)local h=f.contentIndex;local i=f.contentTable;local j=i[h]return j end;g.register=function(self,k)assert(type(k)=="table","[XAF Graphic] Expected TABLE as argument #1")if f.active==true then if k[1]=="touch"then local l=k[2]if l==f.renderer.getScreen()then local m=k[3]local n=k[4]local o=f.renderMode;if n==f.positionY+1 then local k=nil;local p={}if m==f.positionX+f.columns+4 then k=f.eventClick;p=f.eventClickArguments;if f.contentIndex>1 then f.contentIndex=f.contentIndex-1 end elseif m==f.positionX+f.columns+6 then k=f.eventClick;p=f.eventClickArguments;if f.contentIndex<f.contentLength then f.contentIndex=f.contentIndex+1 end end;g:setRenderMode(3)g:view()g:setRenderMode(o)if k then return k(table.unpack(p))end end end elseif k[1]=="scroll"then local l=k[2]if l==f.renderer.getScreen()then local q=k[3]local r=k[4]local s=k[5]local o=f.renderMode;local t=0;local u=0;local v=0;local w=0;if o<=1 then t=f.positionX;u=f.positionY;v=f.positionX+f.totalWidth-1;w=f.positionY+f.totalHeight-1 elseif o<=2 then t=f.positionX+1;u=f.positionY+1;v=f.positionX+f.totalWidth-2;w=f.positionY+f.totalHeight-2 elseif o<=3 then t=f.positionX+2;u=f.positionY+1;v=f.positionX+f.totalWidth-2;w=f.positionY+f.totalHeight-2 end;if q>=t and q<=v and(r>=u and r<=w)then local k=f.eventScroll;local p=f.eventScrollArguments;if f.contentIndex>1 and s<0 then f.contentIndex=f.contentIndex-1 elseif f.contentIndex<f.contentLength and s>0 then f.contentIndex=f.contentIndex+1 end;g:setRenderMode(3)g:view()g:setRenderMode(o)if k then return k(table.unpack(p))end end end end end end;g.setCounter=function(self,x,y,z)assert(type(x)=="number","[XAF Graphic] Expected NUMBER as argument #1")assert(type(y)=="number","[XAF Graphic] Expected NUMBER as argument #2")assert(type(z)=="number","[XAF Graphic] Expected NUMBER as argument #3")local A=x;local B=y;local C=z;local D=1;if f.spinnerMode==0 or f.spinnerMode==1 then if z<=0 then error("[XAF Error] Increment number must be positive")end;if A<B then f.contentTable={}f.contentIndex=1;f.contentValue=nil;f.contentLength=0;for E=A,B,C do f.contentTable[D]=E;f.contentLength=f.contentLength+1;D=D+1 end else error("[XAF Error] Minimum value must be lower than maximum")end else error("[XAF Error] Invalid spinner type - required DEFAULT or COUNTER")end;return true end;g.setIterator=function(self,i)assert(type(i)=="table","[XAF Graphic] Expected TABLE as argument #1")if f.spinnerMode==2 then f.contentTable={}f.contentIndex=1;f.contentValue=nil;f.contentLength=0;for F,G in ipairs(i)do f.contentTable[F]=G;f.contentLength=f.contentLength+1 end else error("[XAF Error] Invalid spinner type - required ITERATOR")end;return true end;g.setOnClick=function(self,H,...)assert(type(H)=="function","[XAF Graphic] Expected FUNCTION as argument #1")local I=H;local J={...}f.eventClick=I;f.eventClickArguments=J;return true end;g.setOnScroll=function(self,H,...)assert(type(H)=="function","[XAF Graphic] Expected FUNCTION as argument #1")local I=H;local J={...}f.eventScroll=I;f.eventScrollArguments=J;return true end;g.view=function(self)local K=f.renderer;if K then local L=f.columns;local M=f.totalWidth;local N=f.totalHeight;local O=f.positionX;local P=f.positionY;local Q=K.getBackground()local R=K.getForeground()local o=f.renderMode;if o<=1 then K.setBackground(f.colorBackground)K.setForeground(f.colorBorder)K.fill(O,P,M-1,1,'─')K.fill(O,P+N-1,M-1,1,'─')K.fill(O,P,1,N-1,'│')K.fill(O+M-1,P,1,N-1,'│')K.set(O,P,'┌')K.set(O+M-1,P,'┐')K.set(O,P+N-1,'└')K.set(O+M-1,P+N-1,'┘')K.set(O+L+3,P+1,'│')K.set(O+L+5,P+1,'│')K.set(O+L+3,P,'┬')K.set(O+L+5,P,'┬')K.set(O+L+3,P+2,'┴')K.set(O+L+5,P+2,'┴')end;if o<=2 then K.setBackground(f.colorBackground)K.set(O+1,P+1,' ')K.set(O+L+2,P+1,' ')end;if o<=3 then local S=f.contentTable[f.contentIndex]local T=S==nil and''or tostring(S)K.setBackground(f.colorBackground)K.setForeground(f.colorContent)K.fill(O+2,P+1,L,1,' ')K.set(O+L+4,P+1,'⇩')K.set(O+L+6,P+1,'⇧')K.set(O+2,P+1,string.sub(T,1,L))end;K.setBackground(Q)K.setForeground(R)return true else error("[XAF Error] Component GPU renderer has not been initialized")end end;return{private=f,public=g}end;function d:extend()local U=self:initialize()local f=U.private;local g=U.public;if self.C_INHERIT==true then return{private=f,public=g}else error("[XAF Error] Class '"..tostring(self.C_NAME).."' cannot be inherited")end end;function d:new(V,W,L,X)local U=self:initialize()local f=U.private;local g=U.public;g:setPosition(V,W)assert(type(L)=="number","[XAF Graphic] Expected NUMBER as argument #3")if c:checkNatural(L,true)==true then f.columns=L else error("[XAF Error] Invalid columns number - must be a positive integer")end;assert(type(X)=="number","[XAF Graphic] Expected NUMBER as argument #4")if X>=0 and X<=2 then if c:checkInteger(X)==true then f.spinnerMode=X else error("[XAF Error] Invalid spinner mode - must be a integer")end else error("[XAF Error] Invalid spinner mode")end;f.totalWidth=L+8;f.totalHeight=3;if self.C_INSTANCE==true then return g else error("[XAF Error] Class '"..tostring(self.C_NAME).."' cannot be instanced")end end;return d
