local a={C_NAME="Abstract Network Server",C_INSTANCE=false,C_INHERIT=true,static={}}function a:initialize()local b=nil;local c=b and b.private or{}local d=b and b.public or{}c.active=false;c.eventStart=nil;c.eventStartArguments={}c.eventStop=nil;c.eventStopArguments={}c.componentModem=nil;c.port=1;c.process=nil;d.getModem=function(self)return c.componentModem end;d.getPort=function(self)return c.port end;d.isRunning=function(self)return c.active end;d.process=function(self,e)assert(type(e)=="table","[XAF Network] Expected TABLE as argument #1")local f=c.componentModem;local g=c.port;local h=f.address;if c.active==true then if f then if e[1]=="modem_message"then if e[2]==h and e[4]==g then local i=e[6]local j=_G._XAF._VERSION;local k=e[3]local l=e[6]if i==j then if type(c.process)=="function"then return c:process(e)else error("[XAF Error] Server processing function has not been initialized - running default")end else f.send(k,l,false,"XAF Version Mismatch")end end end else error("[XAF Error] Server network modem component has not been initialized")end else error("[XAF Error] Server is already stopped")end end;d.setModem=function(self,f)assert(type(f)=="table","[XAF Network] Expected TABLE as argument #1")if f.type=="modem"then c.componentModem=f else error("[XAF Error] Invalid network modem component")end;return true end;d.setOnStart=function(self,m,...)assert(type(m)=="function","[XAF Network] Expected FUNCTION as argument #1")local n=m;local o={...}c.eventStart=n;c.eventStartArguments=o;return true end;d.setOnStop=function(self,m,...)assert(type(m)=="function","[XAF Network] Expected FUNCTION as argument #1")local n=m;local o={...}c.eventStop=n;c.eventStopArguments=o;return true end;d.setPort=function(self,g)assert(type(g)=="number","[XAF Network] Expected NUMBER as argument #1")if g>=1 and g<=65535 then c.port=g else error("[XAF Error] Invalid port number - must be a positive integer up to 65535")end;return true end;d.start=function(self)local e=c.eventStart;local p=c.eventStartArguments;local f=c.componentModem;local g=c.port;if c.active==true then error("[XAF Error] Server is already started")end;if f then if f.isOpen(g)==false then c.active=true;f.open(g)end else error("[XAF Error] Server network modem component has not been initialized")end;if e then return e(table.unpack(p))end end;d.stop=function(self)local e=c.eventStop;local p=c.eventStopArguments;local f=c.componentModem;local g=c.port;if c.active==false then error("[XAF Error] Server is already stopped")end;if f then if f.isOpen(g)==true then c.active=false;f.close(g)end else error("[XAF Error] Server network modem component has not been initialized")end;if e then return e(table.unpack(p))end end;return{private=c,public=d}end;function a:extend()local q=self:initialize()local c=q.private;local d=q.public;if self.C_INHERIT==true then return{private=c,public=d}else error("[XAF Error] Class '"..tostring(self.C_NAME).."' cannot be inherited")end end;function a:new()local q=self:initialize()local c=q.private;local d=q.public;if self.C_INSTANCE==true then return d else error("[XAF Error] Class '"..tostring(self.C_NAME).."' cannot be instanced")end end;return a
