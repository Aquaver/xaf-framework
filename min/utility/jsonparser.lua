local a={C_NAME="Generic JSON Parser",C_INSTANCE=true,C_INHERIT=true,static={}}function a:initialize()local b=nil;local c=b and b.private or{}local d=b and b.public or{}c.currentCharacter=''c.currentIndex=0;c.inputData=''c.stringEscapes={['b']="\b",['n']="\n",['t']="\t",['r']="\r",['f']="\f",['\"']='\"',["\\"]="\\"}c.getNextCharacter=function(self)c.currentIndex=c.currentIndex+1;c.currentCharacter=string.sub(c.inputData,c.currentIndex+1,c.currentIndex+1)return c.currentCharacter end;c.getValue=function(self)if c.currentCharacter=='['then return c:parseArray()elseif c.currentCharacter=='t'or c.currentCharacter=='f'then return c:parseBoolean()elseif c.currentCharacter=='n'then return c:parseNull()elseif c.currentCharacter=='-'or c.currentCharacter and c.currentCharacter>='0'and c.currentCharacter<='9'then return c:parseNumber()elseif c.currentCharacter=='{'then return c:parseObject()elseif c.currentCharacter=='\"'then return c:parseString()else error("[XAF Error] Syntax error encountered while parsing JSON data")end end;c.parseArray=function(self)local e={}if c.currentCharacter=='['then if c:getNextCharacter()==']'then return e end;repeat table.insert(e,c:getValue())if c.currentCharacter==']'then c:getNextCharacter()return e end until not(c.currentCharacter and c.currentCharacter==','and c:getNextCharacter())else error("[XAF Error] Syntax error encountered while parsing JSON data - parsing array")end end;c.parseBoolean=function(self)local f=''if c.currentCharacter=='t'then for g=1,4 do f=f..c.currentCharacter;c:getNextCharacter()end;if f=="true"then return true else error("[XAF Error] Syntax error encountered while parsing JSON data - parsing boolean (true)")end elseif c.currentCharacter=='f'then for g=1,5 do f=f..c.currentCharacter;c:getNextCharacter()end;if f=="false"then return false else error("[XAF Error] Syntax error encountered while parsing JSON data - parsing boolean (false)")end else error("[XAF Error] Syntax error encountered while parsing JSON data - parsing boolean")end end;c.parseNull=function(self)local h=''if c.currentCharacter=='n'then for g=1,4 do h=h..c.currentCharacter;c:getNextCharacter()end;if h=="null"then return nil else error("[XAF Error] Syntax error encountered while parsing JSON data - parsing null")end else error("[XAF Error] Syntax error encountered while parsing JSON data - parsing null")end end;c.parseNumber=function(self)local i=''if c.currentCharacter=='-'then i=i..c.currentCharacter;c:getNextCharacter()end;while c.currentCharacter and c.currentCharacter>='0'and c.currentCharacter<='9'do i=i..c.currentCharacter;c:getNextCharacter()end;if c.currentCharacter=='.'then i=i..c.currentCharacter;c:getNextCharacter()while c.currentCharacter and c.currentCharacter>='0'and c.currentCharacter<='9'do i=i..c.currentCharacter;c:getNextCharacter()end end;if c.currentCharacter=='e'or c.currentCharacter=='E'then i=i..c.currentCharacter;c:getNextCharacter()if c.currentCharacter=='-'or c.currentCharacter=='+'then i=i..c.currentCharacter;c:getNextCharacter()end;while c.currentCharacter and c.currentCharacter>='0'and c.currentCharacter<='9'do i=i..c.currentCharacter;c:getNextCharacter()end end;if tonumber(i)then return tonumber(i)else error("[XAF Error] Syntax error encountered while parsing JSON data - parsing number")end end;c.parseObject=function(self)local j={}if c.currentCharacter=='{'then if c:getNextCharacter()=='}'then return j end;repeat local k=c:parseString()if c.currentCharacter==':'then c:getNextCharacter()j[k]=c:getValue()if c.currentCharacter=='}'then c:getNextCharacter()return j end else error("[XAF Error] Syntax error encountered while parsing JSON data - parsing object (colon expected)")end until not(c.currentCharacter and c.currentCharacter==','and c:getNextCharacter())else error("[XAF Error] Syntax error encountered while parsing JSON data - parsing object")end end;c.parseString=function(self)local l=''if c.currentCharacter=='\"'then c:getNextCharacter()while c.currentCharacter do if c.currentCharacter=='\"'then c:getNextCharacter()return l end;if c.currentCharacter=="\\"then c:getNextCharacter()if c.stringEscapes[c.currentCharacter]then l=l..c.stringEscapes[c.currentCharacter]else l=l..c.currentCharacter end else l=l..c.currentCharacter end;c:getNextCharacter()end else error("[XAF Error] Syntax error encountered while parsing JSON data - parsing string")end end;d.parse=function(self,m)assert(type(m)=="string","[XAF Core] Expected STRING as argument #1")c.inputData=m;c.currentCharacter=string.sub(c.inputData,1,1)c.currentIndex=0;return c:getValue(inputData)end;return{private=c,public=d}end;function a:extend()local n=self:initialize()local c=n.private;local d=n.public;if self.C_INHERIT==true then return{private=c,public=d}else error("[XAF Error] Class '"..tostring(self.C_NAME).."' cannot be inherited")end end;function a:new()local n=self:initialize()local c=n.private;local d=n.public;if self.C_INSTANCE==true then return d else error("[XAF Error] Class '"..tostring(self.C_NAME).."' cannot be instanced")end end;return a
